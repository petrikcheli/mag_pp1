{% extends "base.html" %}

{% block title %}–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤{% endblock %}

{% block content %}

{% load static %}
<link rel="stylesheet" href="{% static 'css/history.css' %}">

<h1>–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á—ë—Ç–æ–≤</h1>

<!-- üîç –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
<form method="get" style="margin-bottom: 20px;">
    <input type="text"
           name="query"
           value="{{ query }}"
           placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ —á–∞—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞..."
           style="padding: 6px; width: 260px;">
    <button type="submit">–ü–æ–∏—Å–∫</button>
</form>

{% if calculations %}
    <ul>
    {% for calc in calculations %}
        <li class="calc-item">
            <details>
                <summary class="calc-summary">
                    <span class="calc-title">
                        <b>{{ calc.name|default:"–ë–µ–∑ –∏–º–µ–Ω–∏" }}</b> ‚Äî {{ calc.created_at|date:"d.m.Y H:i" }}
                    </span>

                    <span class="calc-actions">
                        <form method="post" action="{% url 'delete_calculation' calc.id %}" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-delete btn-small">–£–¥–∞–ª–∏—Ç—å</button>
                        </form>

                        <a href="{% url 'pdf_calculation' calc.id %}" target="_blank" class="btn btn-pdf btn-small">
                            PDF
                        </a>
                    </span>
                </summary>

                <h4>–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:</h4>
                <ul>
                {% for key, value in calc.input_data.items %}
                    <li><b>{{ key }}:</b> {{ value }}</li>
                {% endfor %}
                </ul>

                <h4>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h4>
                <ul>
                {% for key, value in calc.result_data.items %}
                    <li><b>{{ key }}:</b> {{ value }}</li>
                {% endfor %}
                </ul>
            </details>
        </li>
    {% endfor %}
    </ul>



{% else %}
    <p>–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤.</p>
{% endif %}

{% endblock %}
